var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireDefault(require("react"));var _reactNative=require("react-native");var _components=require("@ui-kitten/components");var _reactNativeCodePush=_interopRequireDefault(require("react-native-code-push"));var _reactNativeAnimatedNumbers=_interopRequireDefault(require("react-native-animated-numbers"));var _update=_interopRequireDefault(require("./update.styles"));var _this=this,_jsxFileName="";_reactNativeCodePush.default.allowRestart();var UpdateScreen=function UpdateScreen(_ref){var navigation=_ref.navigation;var _React$useState=_react.default.useState(null),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),updateData=_React$useState2[0],setUpdateData=_React$useState2[1];var _React$useState3=_react.default.useState(false),_React$useState4=(0,_slicedToArray2.default)(_React$useState3,2),isLoading=_React$useState4[0],setIsLoading=_React$useState4[1];var _React$useState5=_react.default.useState(false),_React$useState6=(0,_slicedToArray2.default)(_React$useState5,2),isDownloading=_React$useState6[0],setIsDownloading=_React$useState6[1];var _React$useState7=_react.default.useState(false),_React$useState8=(0,_slicedToArray2.default)(_React$useState7,2),isInstalling=_React$useState8[0],setIsInstalling=_React$useState8[1];var _React$useState9=_react.default.useState(0),_React$useState10=(0,_slicedToArray2.default)(_React$useState9,2),animateToNumber=_React$useState10[0],setAnimateToNumber=_React$useState10[1];var _React$useState11=_react.default.useState(''),_React$useState12=(0,_slicedToArray2.default)(_React$useState11,2),text=_React$useState12[0],setText=_React$useState12[1];var downloadedPackage=_react.default.useRef(null);_react.default.useEffect(function(){checkUpdate();},[]);var checkUpdate=function checkUpdate(){var newUpdateData;return _regenerator.default.async(function checkUpdate$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.prev=1;_context.next=4;return _regenerator.default.awrap(_reactNativeCodePush.default.checkForUpdate(_reactNative.Platform.OS==='ios'?'BDICIqYEsquLexDJspnZpZ0j0e_O_Cbr0vUHD':'lxaj-AelDzx77gjsOly04YXqDjxSTmCqIUkAz'));case 4:newUpdateData=_context.sent;setUpdateData(newUpdateData);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](1);console.log(_context.t0);case 11:_context.prev=11;setIsLoading(false);return _context.finish(11);case 14:case"end":return _context.stop();}}},null,null,[[1,8,11,14]],Promise);};var onPressBack=function onPressBack(){return navigation.pop();};var onPressCheckUpdate=function onPressCheckUpdate(){return checkUpdate();};var BackIcon=function BackIcon(props){return _react.default.createElement(_components.Icon,(0,_extends2.default)({name:"chevron-left-outline"},props,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:53,columnNumber:12}}));};var BackAction=function BackAction(){return _react.default.createElement(_components.TopNavigationAction,{icon:BackIcon,onPress:onPressBack,__self:_this,__source:{fileName:_jsxFileName,lineNumber:57,columnNumber:5}});};var ReloadIcon=function ReloadIcon(props){return _react.default.createElement(_components.Icon,(0,_extends2.default)({name:"repeat-outline"},props,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:61,columnNumber:12}}));};var ReloadAction=function ReloadAction(){return _react.default.createElement(_components.TopNavigationAction,{hitSlop:{left:10,right:10,top:10,bottom:10},icon:ReloadIcon,onPress:onPressCheckUpdate,__self:_this,__source:{fileName:_jsxFileName,lineNumber:65,columnNumber:5}});};var onPressDownload=function onPressDownload(){return _regenerator.default.async(function onPressDownload$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_reactNativeCodePush.default.sync({updateDialog:true},function(status){switch(status){case _reactNativeCodePush.default.SyncStatus.CHECKING_FOR_UPDATE:setText('Yoxlanılır');break;case _reactNativeCodePush.default.SyncStatus.DOWNLOADING_PACKAGE:setText('Paket endirilir...');break;case _reactNativeCodePush.default.SyncStatus.INSTALLING_UPDATE:setText('Paket yüklənir...');break;case _reactNativeCodePush.default.SyncStatus.UPDATE_INSTALLED:setText('Paket yükləndi');_reactNativeCodePush.default.restartApp();break;case _reactNativeCodePush.default.SyncStatus.UPDATE_IGNORED:setText('Yeniləmə dayandırıldı');default:break;}}).then(function(resp){}).catch(function(error){return console.log(error);});case 1:case"end":return _context2.stop();}}},null,null,null,Promise);};var renderContent=function renderContent(){var isDownloaded=animateToNumber===100;if(isLoading){return _react.default.createElement(_components.Spinner,{animating:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:113,columnNumber:14}});}else if(updateData===null){return _react.default.createElement(_reactNative.View,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:116,columnNumber:9}},_react.default.createElement(_components.Text,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:117,columnNumber:11}},"Yeni versiya m\xF6vcud deyil"));}else{var label=updateData.label,appVersion=updateData.appVersion,isMandatory=updateData.isMandatory,packageSize=updateData.packageSize,downloadUrl=updateData.downloadUrl,isPending=updateData.isPending,failedInstall=updateData.failedInstall;return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_components.Text,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:132,columnNumber:11}},label),_react.default.createElement(_components.Text,{category:"h4",style:{marginVertical:20},__self:_this,__source:{fileName:_jsxFileName,lineNumber:133,columnNumber:11}},text),_react.default.createElement(_components.Button,{onPress:onPressDownload,__self:_this,__source:{fileName:_jsxFileName,lineNumber:151,columnNumber:11}},"Download and Install"));}};return _react.default.createElement(_reactNative.SafeAreaView,{style:_update.default.container,__self:_this,__source:{fileName:_jsxFileName,lineNumber:158,columnNumber:5}},_react.default.createElement(_components.TopNavigation,{title:!isLoading?'Yeniləmə':'Yeni versiya yoxlanılır...',alignment:"center",accessoryLeft:BackAction,accessoryRight:ReloadAction,__self:_this,__source:{fileName:_jsxFileName,lineNumber:159,columnNumber:7}}),_react.default.createElement(_components.Divider,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:165,columnNumber:7}}),_react.default.createElement(_reactNative.View,{style:_update.default.content,__self:_this,__source:{fileName:_jsxFileName,lineNumber:166,columnNumber:7}},renderContent()));};var _default=UpdateScreen;exports.default=_default;

//# sourceMappingURL=update.component.js.map